<table cellpadding="3" cellspacing="0">
	<tr>
		<td align="right" style="width: 140px"><cpanel langprint="BUDestination"></td>
		<td colspan="2">
			<select name="dest" id="backup_dest">
				<option value="homedir" selected="selected"><cpanel langprint="BUFullOptHome"></option>
				<option value="ftp"><cpanel langprint="BUFullOptRemoteFTP"></option>
				<option value="passiveftp"><cpanel langprint="BUFullOptRemoteFTPPasv"></option>
				<option value="scp"><cpanel langprint="BUscp"></option>
			</select>
		</td>
	</tr>
	<tr>
		<td align="right" style="padding-top:10px"><cpanel langprint="BUEmailAddy"></td>
		<td style="text-align:left; padding-top:10px">
            <input type="radio" name="email_radio" value="1" onclick="this.form.email.disabled = false; email_validator.verify()" checked="checked" />&nbsp;<input style="width:150px" type="text" name="email" id="backup_email" value="<cpanel CustInfo="getemail()">" style="width: 150px" onchange="if (this.value.trim() === &quot;&quot;) { this.disabled = true; document.getElementById(&quot;email_radio_0&quot;).checked = true; email_validator.clear_messages() }" />
            <span id="backup_email_error" style="vertical-align:middle"></span>
            <br />
            <label><input type="radio" id="email_radio_0" name="email_radio" value="0" onclick="this.form.email.disabled = true; email_validator.clear_messages()" />&nbsp;<cptext "Do not send email notification of backup completion."></label>
        </td>
	</tr>
	<tr>
		<td>&nbsp;</td>
        <td></td>
	</tr>
</table>
<div id="backup_advanced" style="display: none">
	<table cellpadding="3" cellspacing="0">
		<tr>
			<td align="right" style="width: 140px"><cpanel langprint="BURemoteServer"></td>
			<td><input type="text" name="server" id="backup_server" style="width: 150px" /></td>
			<td><div id="backup_server_error"></div></td>
		</tr>
		<tr>
			<td align="right"><cpanel langprint="BURemoteUser"></td>
			<td><input type="text" name="user" id="backup_user" style="width: 150px" /></td>
			<td><div id="backup_user_error"></div></td>
		</tr>
		<tr>
			<td align="right"><cpanel langprint="BURemotePass"></td>
			<td><input type="password" name="pass" id="backup_pass" style="width: 150px" /></td>
			<td><div id="backup_pass_error"></div></td>
		</tr>
		<tr>
			<td align="right"><cpanel langprint="BUPort">:</td>
			<td><input type="text" name="port" id="backup_port" style="width: 150px" /></td>
			<td><div id="backup_port_error"></div></td>
		</tr>
		<tr>
			<td align="right"><cpanel langprint="BURemoteDir">:</td>
			<td><input type="text" name="rdir" id="backup_rdir" style="width: 150px" /></td>
			<td><div id="backup_rdir_error"></div></td>
		</tr>
	</table>
</div>
<table cellpadding="3" cellspacing="0">
	<tr><td colspan="3"><br /></td></tr>
	<tr>
		<td style="width: 140px">&nbsp;</td>
		<td colspan="2"><input type="submit" class="input-button" id="backup_submit" value="<cpanel langprint="BUGenerageButton">" /></td>
	</tr>
</table>
<script type="text/javascript">
//<![CDATA[
var email_validator = new CPANEL.validate.validator("<cpanel Locale="maketext('Notification Email')">");
var raddress_validator = new CPANEL.validate.validator("<cpanel Locale="maketext('Remote Server Address')">");
var ruser_validator = new CPANEL.validate.validator("<cpanel Locale="maketext('Remote Server User')">");
var rpassword_validator = new CPANEL.validate.validator("<cpanel Locale="maketext('Remote Server Password')">");
var rport_validator = new CPANEL.validate.validator("<cpanel Locale="maketext('Remote Server Port')">");
var rdirectory_validator = new CPANEL.validate.validator("<cpanel Locale="maketext('Remote Server Directory')">");

// address cannot be empty or contain spaces
var raddress = function() {
	if (YAHOO.util.Dom.get("backup_dest").value != "homedir") {
		var value = YAHOO.util.Dom.get("backup_server").value;
		if (CPANEL.validate.min_length(value, 1) == false) return false;
		if (CPANEL.validate.no_chars(value, " ") == false) return false;
		return true;
	}
	else return true;
};

// user cannot be empty
var ruser = function() {
	if (YAHOO.util.Dom.get("backup_dest").value != "homedir") {
		return CPANEL.validate.min_length(YAHOO.util.Dom.get("backup_user").value, 1);
	}
	else return true;
};

// password cannot be blank
var rpassword = function() {
	if (YAHOO.util.Dom.get("backup_dest").value != "homedir") {
		return CPANEL.validate.min_length(YAHOO.util.Dom.get("backup_pass").value, 1);
	}
	else return true;
};

// port must be a positive integer
var rport = function() {
	if (YAHOO.util.Dom.get("backup_dest").value != "homedir") {
		return CPANEL.validate.positive_integer(YAHOO.util.Dom.get("backup_port").value);
	}
	else return true;
};

// directory cannot be blank
var rdirectory = function() {
	if (YAHOO.util.Dom.get("backup_dest").value != "homedir") {
		return CPANEL.validate.dir_path(YAHOO.util.Dom.get("backup_rdir").value);
	}
	else return true;
};

var switch_destination = function() {
	if (YAHOO.util.Dom.get("backup_dest").value == "homedir") {
		raddress_validator.clear_messages();
		ruser_validator.clear_messages();
		rpassword_validator.clear_messages();
		rport_validator.clear_messages();
		rdirectory_validator.clear_messages();
        CPANEL.animate.slide_up('backup_advanced');
	}
	else if ( DOM.getStyle('backup_advanced','display') == 'none' ) {
        CPANEL.animate.slide_down( 'backup_advanced', function() {
			YAHOO.util.Dom.get("backup_server").focus();
		});
	}
};

var init_backup = function() {
	email_validator.add("backup_email", "email", "<cptext "Invalid email address">");
	email_validator.attach();
	
	raddress_validator.add("backup_server", raddress, "<cpanel Locale="maketext('Remote server cannot be empty or have spaces.')">");
	raddress_validator.attach();
	
	ruser_validator.add("backup_user", ruser, "<cpanel Locale="maketext('Remote user cannot be empty.')">");
	ruser_validator.attach();
	
	rpassword_validator.add("backup_pass", rpassword, "<cpanel Locale="maketext('Remote password cannot be empty.')">");
	rpassword_validator.attach();
	
	rport_validator.add("backup_port", rport, "<cpanel Locale="maketext('Remote port must be a positive integer.')">");
	rport_validator.attach();
	
	rdirectory_validator.add("backup_rdir", rdirectory, "<cpanel langprint="validation_directory_paths">");
	rdirectory_validator.attach();
	
	YAHOO.util.Event.on("backup_dest", "change", switch_destination);
	
	CPANEL.validate.attach_to_form("backup_submit", [email_validator, raddress_validator, ruser_validator, rpassword_validator, rport_validator, rdirectory_validator]);
	
	email_validator.verify();

    switch_destination();
};
YAHOO.util.Event.onDOMReady(init_backup);
//]]>
</script>
