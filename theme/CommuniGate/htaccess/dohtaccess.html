<cpanel setvar="headerimg=../images/topwebprotect.gif">
<cpanel setvar="dprefix=../">
<cpanel Branding="include(stdheader.html)">

<style type="text/css">
<?cp Branding::spritelist(.spriteicon_img_mini {float:left;margin-right:5px;background: url\{leftparenthesis}"%"\{rightparenthesis};} %,@spriteurl,images::#icon-${img}_mini {background-position\{colon}0 -${cssposition}px;width\{colon}${width}px;height\{colon}${height}px; }:) imgtype=icon,subtype=img,method=scale_60percent,format=png,img=password-protect ?>
</style>

<div class="body-content">

<?cp Frontpage::fpenabled(%,fpenabled) ?>

<cpanelif $CPVAR{'fpenabled'}>
	<p class="alert_box">
	<strong><cpanel langprint="Warning2"></strong>:<br />
	<cpanel langprint="FPPPDWarning">
	</p>
</cpanelif>

<cpanelif !$CPVAR{'fpenabled'}>

<div class="h1Title"><div class="spriteicon_img_mini" id="icon-password-protect_mini"></div><cpanel langprint="NavProtectDir"></div>

<p class="description"><cpanel langprint="PPDesc"></p>
<br />

<h2><cpanel langprint="PPDSetPermDirPre"> <cpanel print="$FORM{'dir'}"></h2><br />

<form action="changepro.html" method="get">
	<input type="hidden" name="dir" value="<cpanel print="$FORM{'dir'}">" />
	<h2><div align="left"><cpanel langprint="SecSet">:</div></h2>
	<div class="highlight">
		<p class="description"><cpanel langprint="ProtectNameDesc"></p>
		<table cellpadding="3" cellspacing="0">
			<tr>
				<td align="right"><label for="protect_dir_checkbox"><cpanel langprint="PassProtect"></label>:</td>
				<td><input type="checkbox" name="protected" <cpanel Htaccess="checkprotected($FORM{'dir'})"> value="1" id="protect_dir_checkbox" /></td>
				<td>&nbsp;</td>
			</tr>
			<tr>
				<td align="right"><cpanel langprint="PassName">:</td>
				<td><input type="text" name="resname" value="<cpanel Htaccess="resname($FORM{'dir'})">" id="resname" /></td>
				<td><div id="resname_error"></div></td>
			</tr>
			<tr><td colspan="2"><br /></td></tr>
			<tr>
				<td>&nbsp;</td>
				<td colspan="2"><input name="action2" type="submit" id="submit_dir_name" class="input-button" value="<cpanel langprint="PPDSaveButton">" /></td>
			</tr>
		</table>
	</div>
</form>
<script type="text/javascript">
//<![CDATA[
var init_security_validation = function() {
	var dir_validator = new CPANEL.validate.validator("<cpanel Locale="maketext('Directory Name')">");
	dir_validator.add("resname", "min_length(%input%, 1)", "<cpanel langprint="htaccess_dir_name_validation">");
	dir_validator.attach();
	
	CPANEL.validate.attach_to_form("submit_dir_name", dir_validator);
};
YAHOO.util.Event.onDOMReady(init_security_validation);
//]]>
</script>
<br />

<form method="post" name="mainform" id="mainform" action="newuser.html">
	<input type="hidden" name="dir" value="<cpanel print="$FORM{'dir'}">" />
	<h2><cpanel langprint="PassUser">:</h2>
	<table cellpadding="0" cellspacing="5"> 
		<tr>
			<td><div align="right"><cpanel langprint="Username">:</div></td>
			<td><input type="text" name="user" id="user" /></td>
			<td><div id="user_error"></div></td>
		</tr>
		<tr>
			<td align="right" style="width: 120px"><cpanel langprint="EANewpass"></td>
			<td><input type="password" name="pass" id="password" style="width: 150px" /></td>
			<td><div id="password_error"></div></td>
		</tr>
		<tr>
			<td align="right"><cpanel langprint="ASIReadOtherPasswordAgain"></td>
			<td><input type="password" name="pass2" id="password2" style="width: 150px" /></td>
			<td><div id="password2_error"></div></td>
		</tr>
		<tr>
			<td align="right">
				<cpanel langprint="email_strength"> (<div style="display: inline" id="why_strong_passwords_link" class="action_link"><cpanel langprint="email_why"></div>):
				<div id="why_strong_passwords_text" style="display: none"><cpanel langprint="email_password_why"><br /><br /><cpanel langprint="email_password_tip"></div>
			</td>
			<td><div id="password_strength" style="width: 150px; height: 20px; border: 1px solid black; margin: 5px 0px 3px 0px"></div></td>
			<td><input type="button" id="create_strong_password" value="<cpanel langprint="cjt_password_generator">" tabindex="-1" /></td>
		</tr>
		<tr><td colspan="3"><br /></td></tr>
		<tr>
			<td>&nbsp;</td>
			<td colspan="2"><input name="action" type="submit" id="submit_user" class="input-button" value="<cpanel langprint="PPDAddButton">"></td>
		</tr>
	</table>
</form>
<script type="text/javascript">
//<![CDATA[
var REQUIRED_PASSWORD_STRENGTH = parseInt('<?cp PasswdStrength::get_required_strength(%,strength) app=htaccess ?>') || 0;

var init_page = function() {
	var user_validator = new CPANEL.validate.validator("<cpanel Locale="maketext('Username')">");
	user_validator.add("user", "filename", "<cpanel langprint="username_filename_chars">");
	user_validator.add("user", "no_chars(%input%, ' ')", "<cpanel langprint="username_nospaces">");
	user_validator.add("user", "alphanumeric_bookends", "<cpanel langprint="username_alphanumeric_bookends">");
	user_validator.attach();
	
	var password_validators = CPANEL.password.setup("password", "password2", "password_strength", REQUIRED_PASSWORD_STRENGTH, "create_strong_password", "why_strong_passwords_link", "why_strong_passwords_text");
	
	password_validators.push(user_validator);
	CPANEL.validate.attach_to_form("submit_user", password_validators);
};
YAHOO.util.Event.onDOMReady(init_page);
//]]>
</script>
<br />

<!-- <cpanel Htaccess="number_of_users($FORM{'dir'})"> -->
<cpanelif !$CPVAR{'htaccess_number_of_users'}==0>
	<form action="deluser.html" method="get">
		<input type="hidden" name="dir" value="<cpanel print="$FORM{'dir'}">" />    
		<h2><div align="left"><cpanel langprint="AuthUsers">:</div></h2>
		<p><class="description"><cpanel langprint="PPDUDesc"></p>
		<table cellpadding="0" cellspacing="5">
			<tr>
				<td height="136" valign="top">
					<select name="user" size="8" style= "width:200px;">
					<cpanel Htaccess="showusers($FORM{'dir'})">
					</select>
				</td>
				<td valign="top" align="right">
					<input name="action" type="submit" class="input-button" value="<cpanel langprint="PPDDelUserButton">" />
				</td>
			</tr>
		</table>
	</form>
</cpanelif>

</cpanelif><!-- end cpanelif !$CPVAR{'fpenabled'} -->

<br />

<div class="return-link"><a href="index.html?dir=<cpanel print="$FORM{'dir'}">">&larr; <cpanel langprint="FMBackto"> <cpanel print="$FORM{'dir'}"></a></div>

</div><!-- end body-content -->

<cpanel Branding="include(stdfooter.html)">
